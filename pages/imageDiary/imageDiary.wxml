<!--pages/imageDiary/imageDiary.wxml-->
<!-- 创建一个move-area -->

<view class='view-mainLayout'>

  <!--图片区  -->
  <view class='view-layoutFirst'>
    <image src='{{imgUrl}}' mode='aspectFit' class='img-uploaded' style='height: {{uploadedImageHeight}}px; width: {{uploadedImageWidth}}px; filter: {{imageFilter}};'></image>
    <movable-area class='movableArea-userInput' disabled="{{isMoveable}}" scale-area='true' style='height: {{uploadedImageHeight}}px; width: {{uploadedImageWidth}}px;'>
      <!-- <movable-view direction='all' scale='true' scale-min='0.5' scale-max='{{(uploadedImageHeight / choseTextModule.height > uploadedImageWidth / choseTextModule.width) ? uploadedImageWidth / (choseTextModule.width * pixelRatio) : uploadedImageHeight / (choseTextModule.height * pixelRatio)}}' style='width: {{choseTextModule.width}}px; height: {{choseTextModule.height}}px;'> -->
      <input class='input-text' style="" hidden="{{!(isInputStatu && isNarrateModel)}}" placeholder='请在这里输入标题' maxlength='6' focus="{{!isFocus}}" bindfocus='textareaOnFocusEvent' bindinput='textareaOnInputEvent' bindblur="textareaOnBlurEvent" id='title'></input>
      <textarea class="input-text" wx:key="this" hidden="{{!isInputStatu}}" auto-height='true' bindfocus='textareaOnFocusEvent' bindinput='textareaOnInputEvent' bindblur="textareaOnBlurEvent" placeholder='请在这里输入文案。' maxlength='{{inputMaxLength}}' placeholder-style='font-size: 13pt'
        show-confirm-bar='false' focus="{{isFocus}}" id='content'></textarea>
      <movable-view hidden="{{isInputStatu}}" direction='all' scale='true' scale-min='0.5' scale-max='2' style='width: {{movableViewWidth}}px; height: {{movableViewHeight}}px;' x='{{(uploadedImageWidth - movableViewWidth) / 2}}px' y='{{(uploadedImageHeight - movableViewHeight) / 2}}px'
        bindchange='onMovableAreaChangeEvent' bindscale='onMovableAreaScaleEvent'>
        <rich-text nodes="{{choseTextModule.nodes}}" bindtap='showTools'></rich-text>
      </movable-view>
    </movable-area>
  </view>
  <!--文本区  -->
  <view class='view-layoutSecond modify-shadow-main-up'>
    <!--切换叙事模式  -->
    <image class="img-changeTextStatus" src="/images/image-clock.svg" hidden="{{!isInputStatu}}" bindtap='changeToNarrate'></image>
    <!--确认输入内容不再修改  -->
    <image class='img-EditDictum' style="top: 300rpx;" src="/images/icon-imageDiary-help.svg" hidden="{{!isInputStatu}}" bindtap='confirm'></image>
    <!--滑动放大  -->
    <slider class='slider-changeRichSize' min='20' max='60' activeColor='#3f8ae9' block-size='20' hidden="{{!isShowTools}}" bindchange='changeRichSize' bindchanging='changeRichSize' value='{{sliderValue}}'></slider>
    <!--切换输入状态  -->
    <image class="img-changeTextStatus" src="/images/image-Dot.svg" hidden="{{!isShowTools}}" bindtap='changeTextReady'></image>
    <!--打开名言窗口  -->
    <image class='img-EditDictum' src="/images/icon-imageDiary-help.svg" hidden="{{!isShowTools}}" bindtap='powerDrawer' data-statu="open"></image>
    <!--分享按钮  -->
    <view class='view-layoutSecond-shareButton' bindtap='saveDiaryText'>
      <image src="/images/icon-imageDiary-shareButton.png" class='img-share'></image>
    </view>
    <view class='view-layoutSecond-preview'>
      <!-- 文本模板预览区 -->
      <view class='view-layoutSecond-preview-textModule'>
        <scroll-view scroll-x='true' class='textModuleScrollView'>
          <view style='border: {{textModuleIndex == choseTextModuleId ? "4rpx solid #3f8ae9": ""}};' wx:key="this" wx:for='{{textModuleScrollView}}' wx:for-item='textModuleItem' wx:for-index='textModuleIndex' class='textModuleScrollView-item' bindtap='onTextModuleItemTap'
            data-text-module-id='{{textModuleItem.systemVariable.id}}' disabled='{{false}}'>
            <rich-text nodes="{{textModuleItem.nodes}}" style='position:relative; bottom: 45rpx; right: 40rpx;'></rich-text>
          </view>
        </scroll-view>
      </view>
      <!-- 颜色模板预览区 -->
      <view class='view-layoutSecond-preview-colorModule'>
        <scroll-view scroll-x='true' class='colorModuleScrollView'>
          <view wx:key="this" wx:for='{{colorModuleScrollView}}' wx:for-item='colorModuleItem' wx:for-index='colorModuleIndex' class='colorModuleScrollView-item'>
            <button class='colorModuleScrollView-item-button' style='background-color:{{colorModuleItem.backgroundColor}}; color:{{colorModuleItem.color}}; border: {{colorModuleIndex == choseColorModuleId ? "8rpx solid #3f8ae9": ""}}' bindtap='onColorModuleItemTap'
              data-color-module-id='{{colorModuleItem.id}}' disabled='{{false}}'>T</button>
          </view>
        </scroll-view>
      </view>
    </view>
    <view class='view-layoutSecond-text'>
      <!--遮蔽层-->
      <view class="drawer-screen" bindtap="powerDrawer" data-statu="close" hidden="{{showModalStatus}}"></view>
      <!--content-->
      <!--使用animation属性指定需要执行的动画-->
      <view animation="{{animationData}}" class="drawer_box" hidden="{{showModalStatus}}">
        <!--drawer content-->
        <view class="drawer-content">
          <view class='view-model'>
            <text>叙事模式</text>
            <switch class='switch-input' checked='{{switchChecked}}' bindchange='switchModel' disabled='{{switchDisabled}}' color='#3f8ae9'></switch>
          </view>
          <!-- <view class='view-eachItem' style='margin-top:20px'>
            <text class="text-eachTitle">文案</text>
            
            <view class='view-line'></view>
            <view class='view-help-and-displayLength'>
              <image class='img-helpLogo' src='/images/icon-imageDiary-help.svg'></image>
              <text class='text-displayLength'>{{inputLength}}/{{inputMaxLength}}</text>
            </view>
          </view> -->
          <view class='view-eachItem view-dictum'>
            <text class='text-eachTitle'>名言</text>
            <view class='view-select-layout'>
              <view class='view-select-box-first'>
                <view class='view-select' id='dictumFirst' catchtap='selectDictum'>
                  <text class='text-select'>{{dataDictumFirst[indexDictumFirst]}}</text>
                </view>
                <view class='view-option-box-first' style='height:{{showDictumFirst?(dataDictumFirst.length>5?300:dataDictumFirst.length*60):0}}rpx;'>
                  <text class='text-option-box' style='{{indexDictumFirst==dataDictumFirst.length-1&&"border:0;"}}' wx:for='{{dataDictumFirst}}' wx:key='this' data-index='{{index}}' id='selectDictumFirst' catchtap='optionDictum'>{{item}}</text>
                </view>
              </view>
              <view class='view-select-box-first'>
                <view class='view-select' id='dictumSecond' catchtap='selectDictum'>
                  <text class='text-select'>{{dataDictumSecond[indexDictumSecond]}}</text>
                </view>
                <view class='view-option-box-first' style='height:{{showDictumSecond?(dataDictumSecond.length>5?300:dataDictumSecond.length*60):0}}rpx;'>
                  <text class='text-option-box' style='{{indexDictumSecond==dataDictumSecond.length-1&&"border:0;"}}' wx:for='{{dataDictumSecond}}' wx:key='this' data-index='{{index}}' id='selectDictumSecond' catchtap='optionDictum'>{{item}}</text>
                </view>
              </view>
              <view class='view-select-box-first'>
                <view class='view-select' id='dictumThird' catchtap='selectDictum'>
                  <text class='text-select' style='font-size:9pt'>{{dataDictumThird[indexDictumThird]}}</text>
                </view>
                <view class='view-option-box-first view-option-box-second' style='height:{{showDictumThird?(dataDictumThird.length>5?300:dataDictumThird.length*60):0}}rpx;'>
                  <text class='text-option-box' style='{{indexDictumThird==dataDictumThird.length-1&&"border:0;"}}' wx:for='{{dataDictumThird}}' wx:key='this' data-index='{{index}}' id='selectDictumThird' catchtap='optionDictum'>{{item}}</text>
                </view>
              </view>
            </view>
          </view>

        </view>
        <view class="btn_ok" bindtap="powerDrawer" data-statu="close">确定</view>
      </view>
    </view>

    <!-- 显示输入的文字 -->
    <!-- <view class='view-eachItem' style='margin-top:10px'>
        <text class="text-eachTitle" bindtap="powerDrawer" data-statu="open" style='{{inputLength == 0 ? "color: grey; font-size: 13pt;" : ""}};'>文案</text>
        <view class='view-show-text' bindtap="powerDrawer" data-statu="open">{{inputValue}}</view>
        <view class='view-line' bindtap="powerDrawer" data-statu="open" style='{{inputLength == 0 ? "background-color: grey;" : "height: 4rpx"}};'></view>
      </view> -->

    <!--显示样式  -->
    <!-- <view class='view-eachItem view-style' style='margin-top: 5%;'>
        <text class='text-eachTitle'>样式</text>
        <view style='margin-top: 0%;'>
          <slider show-value min='1' max='18' activeColor='#3f8ae9' block-size='20'></slider>
        </view>
      </view> -->

    <!--天气、时空和心情滤镜  -->
    <!-- <view class='view-eachItem' style='margin-top: 8%;'>
        <checkbox-group class='checkgroup-threeItems' style='z-index:{{zIndex}}' bindchange="checkboxChange">
          <label wx:key="this" wx:for="{{items}}">
            <checkbox value="{{item}}" checked="{{item.checked}}" />{{item.value}}
          </label>
        </checkbox-group>
      </view> -->
    <!-- <view class='view-eachItem view-style'>
        <text class='text-eachTitle'>样式</text>
        <view class='view-select-layout view-select-style-layout' style='z-index:{{zIndex}}'>
          <view class='view-select-box-first' style='padding-right:0rpx'>
            <view class='view-select' id='styleFirst' catchtap='selectStyle'>
              <text class='text-select'>{{dataStyleFirst[indexStyleFirst]}}</text>
            </view>
            <view class='view-option-box-first' style='height:{{showStyleFirst?(dataStyleFirst.length>5?300:datavFirst.length*60):0}}rpx;'>
              <text class='text-option-box' style='{{indexStyleFirst==dataStyleFirst.length-1&&"border:0;"}}' wx:for='{{dataStyleFirst}}' wx:key='this' data-index='{{index}}' id='selectStyleFirst' catchtap='optionStyle'>{{item}}</text>
            </view>
          </view>
          <view class='view-select-box-first' style='padding-right:0rpx'>
            <view class='view-select' id='styleSecond' catchtap='selectStyle'>
              <text class='text-select'>{{dataStyleSecond[indexStyleSecond]}}</text>
            </view>
            <view class='view-option-box-first' style='height:{{showStyleSecond?(dataStyleSecond.length>4?240:dataStyleSecond.length*60):0}}rpx;'>
              <text class='text-option-box' style='{{indexStyleSecond==dataStyleSecond.length-1&&"border:0;"}}' wx:for='{{dataStyleSecond}}' wx:key='this' data-index='{{index}}' id='selectStyleSecond' catchtap='optionStyle'>{{item}}</text>
            </view>
          </view>
          <view class='view-select-box-first' style='padding-right:0rpx'>
            <view class='view-select' id='styleThird' catchtap='selectStyle'>
              <text class='text-select' style='font-size:9pt'>{{dataStyleThird[indexStyleThird]}}</text>
            </view>
            <view class='view-option-box-first view-option-box-second' style='height:{{showStyleThird?(dataStyleThird.length>5?300:dataStyleThird.length*60):0}}rpx;'>
              <text class='text-option-box' style='{{indexStyleThird==dataStyleThird.length-1&&"border:0;"}}' wx:for='{{dataStyleThird}}' wx:key='this' data-index='{{index}}' id='selectStyleThird' catchtap='optionStyle'>{{item}}</text>
            </view>
          </view>
        </view>
      </view> -->
    <!-- </view> -->
  </view>
</view>